# Orb 'circleci/welcome-orb@0.4.1' resolved to 'circleci/welcome-orb@0.4.1'
version: 2
jobs:
    install:
        docker:
            - image: circleci/node:dubnium
        working_directory: ~/repo
        steps:
            - checkout
            - restore_cache:
                keys: 
                    - dependencies-{{ .Environment.CACHE_VERSION }}-{{ checksum "package.json" }}
                    - dependencies-{{ .Environment.CACHE_VERSION }}-
            - run:
                command: yarn global add node-gyp && yarn install
                name: yarnCmdTP
            - run:
                command: echo $CACHE_VERSION
                name: cacheVer
            - save_cache:
                paths:
                    - node_modules
                key: dependencies-{{ .Environment.CACHE_VERSION }}-{{ checksum "package.json" }}

    lint:
        docker:
            - image: circleci/node:dubnium
        steps:
            - checkout
            - restore_cache:
                keys: 
                    - dependencies-{{ .Environment.CACHE_VERSION }}-{{ checksum "package.json" }}
                    - dependencies-{{ .Environment.CACHE_VERSION }}-
            - run:
                name: yarn_extra_one
                command: yarn lint
            - run:
                name: yarn_extra_two
                command: yarn format:check
    # unit_test:
    #     steps:
    #         - checkout
    #         - run : 
    #             name: yarn_extra_two
    #             command: yarn test:ci

workflows:
  version: 2
  install_n_build_n_test:
    jobs:
        - install
        - lint : 
            requires:
                - install
        # - unit_test :
        #     requires : 
        #         - install
        #         - lint
